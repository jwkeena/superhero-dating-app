<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Superhero Singles Survey</title>

    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Chosen -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.5.1/chosen.jquery.min.js"></script>

</head>

<body>

    <div class="container">

        <h2>Survey Questions</h2>
        <hr>

        <h3><strong>About You</strong></h3>
        <h4>Name (Required)</h4>
        <input type="text" id="name" class="form-control" required>

        <h4>Link to Photo Image (Optional)</h4>
        <input type="text" id="photo" class="form-control">

        <hr>

        <h3><strong>Question 1</strong></h3>
        <h4>You have endured childhood trauma which informs your current mission in life.</h4>
        <select class="chosen-select" id="q1">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 2</strong></h3>
        <h4>Your powers and abilities are innate.</h4>
        <select class="chosen-select" id="q2">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3 (Neither agree nor disagree)</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly agree)</option>
        </select>


        <h3><strong>Question 3</strong></h3>
        <h4>You prefer to reason with your opponents first and only THEN rip into them with your energy beams.</h4>
        <select class="chosen-select" id="q3">
            <option value=""></option>
            <option value="1">1 (HULK SMASH)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Get ready for a lecture from Professor X)</option>
        </select>


        <h3><strong>Question 4</strong></h3>
        <h4>You're looking for a long-term relationship with someone other than your goofy, inept, vaguely asexual
            sidekick.</h4>
        <select class="chosen-select" id="q4">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>


        <h3><strong>Question 5</strong></h3>
        <h4>You secretly wish you could just be a normal person with no powers, burden of responsibility, or secret
            identity.</h4>
        <select class="chosen-select" id="q5">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3 ("Identity crisis" is my middle name)</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>


        <h3><strong>Question 6</strong></h3>
        <h4>You work best on a team, league, or society.</h4>
        <select class="chosen-select" id="q6">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>


        <h3><strong>Question 7</strong></h3>
        <h4>You like to have a detailed plan before storming the supervillain's fortress.</h4>
        <select class="chosen-select" id="q7">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 8</strong></h3>
        <h4>You think criminals deserve help rather than punishment.</h4>
        <select class="chosen-select" id="q8">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 9</strong></h3>
        <h4>You tend to overshare with those you're close to.</h4>
        <select class="chosen-select" id="q9">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <h3><strong>Question 10</strong></h3>
        <h4>You tend to wear a flamboyant outfit in public, have nice teeth and perfect hair even in the heat of battle,
            and enjoy witty repartee with your archnemesis right after listening to their monologue about how to take
            over the world.</h4>
        <select class="chosen-select" id="q10">
            <option value=""></option>
            <option value="1">1 (Strongly Disagree)</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5 (Strongly Agree)</option>
        </select>

        <br>
        <br>

        <!-- Submit Button -->
        <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle"
                aria-hidden="true"></i>
            Submit</button>

        <hr>
        <footer class="footer">
            <div class="container">
                <p><a href="/api/singles">API Singles List</a> | <a
                        href="https://github.com/jwkeena/superhero-match">GitHub Repo</a></p>
            </div>
        </footer>

    </div>

    <!-- Modal -->
    <div id="results-modal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Modal content-->
            <div class="modal-content text-center">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title"><strong>Your Dream Date Is...</strong></h2>
                </div>
                <div class="modal-body">
                    <h2 id="match-name"></h2>
                    <img id="match-img" style="width: 75%;" src="" alt="A saucy picture of your next hot date.">
                    <br>
                    <p id="message"></p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>

        </div>
    </div>

    <button id="modal-button" style="display: none" type="button" class="btn btn-primary" data-toggle="modal"
        data-target="#results-modal"></button>

    <script type="text/javascript">
        // Grabs user input when the form is submitted, turns it into a JS object, sends it to api route for JSONification and comparison
        $(document).ready(function () {
            $("#submit").on("click", function (e) {
                e.preventDefault();

                // Create new object with user data
                let profile = {
                    name: $("#name").val().trim(),
                    photo: $("#photo").val().trim(),
                    surveyAnswers: [$("#q1").find(":selected").attr("value"),
                        $("#q1").find(":selected").attr("value"),
                        $("#q2").find(":selected").attr("value"),
                        $("#q3").find(":selected").attr("value"),
                        $("#q4").find(":selected").attr("value"),
                        $("#q5").find(":selected").attr("value"),
                        $("#q6").find(":selected").attr("value"),
                        $("#q7").find(":selected").attr("value"),
                        $("#q8").find(":selected").attr("value"),
                        $("#q9").find(":selected").attr("value"),
                        $("#q10").find(":selected").attr("value")
                    ]
                }

                console.log(profile);

                $.post("/api/singles", profile)
                    .then(function (data) {
                        console.log(data);
                        console.log(data.name);
                        console.log(data.photo);

                        // Open modal with result of the closest match
                        $("#modal-button").click();
                        $("#match-name").text(data.name);
                        $("#message").text(data.message);
                        $("#match-img").attr("src", data.photo);

                    })

            })
        })
    </script>

</body>

</html>